# Run these commands to fix the missing migrations:

# Step 1: Generate missing migration files
docker-compose exec -T backend bash -c "
export DJANGO_COLUMNS=0
cd /app
echo 'ğŸ“ Creating migration files...'
python manage.py makemigrations users --noinput
python manage.py makemigrations learning --noinput
python manage.py makemigrations --merge --noinput
echo 'âœ… Migration files created'
"

# Step 2: Apply migrations
docker-compose exec -T backend bash -c "
export DJANGO_COLUMNS=0  
cd /app
echo 'ğŸ”„ Applying migrations...'
python manage.py migrate --noinput
echo 'âœ… Migrations applied'
"

# Step 3: Create admin user
docker-compose exec -T backend bash -c "
export DJANGO_COLUMNS=0
cd /app
echo 'ğŸ‘¤ Creating admin user...'
python manage.py shell -c \"
import os, django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()
from django.contrib.auth import get_user_model
User = get_user_model()
if not User.objects.filter(username='admin').exists():
    User.objects.create_superuser('admin', 'admin@jacplatform.com', 'admin123')
    print('Admin created successfully')
else:
    print('Admin already exists')
\"
"